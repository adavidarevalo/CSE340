<% if (title) { %>
  <h1><%= title %></h1>
<% } else {res.redirect('/')} %>

<%- messages() %>

<div class="user-reviews">
  <% if (reviews && reviews.length > 0) { %>
    <p>You have written <%= reviews.length %> review<%= reviews.length === 1 ? '' : 's' %>.</p>
    
    <div class="reviews-list">
      <% reviews.forEach(function(review) { %>
        <div class="review-item">
          <div class="review-header">
            <h3><a href="/inv/detail/<%= review.inv_id %>"><%= review.inv_year %> <%= review.inv_make %> <%= review.inv_model %></a></h3>
            <div class="review-rating">
              <% for(let i = 1; i <= 5; i++) { %>
                <span class="star <%= i <= review.review_rating ? 'filled' : '' %>">â˜…</span>
              <% } %>
            </div>
          </div>
          
          <div class="review-content">
            <h4><%= review.review_title %></h4>
            <p><%= review.review_text %></p>
            <small>Reviewed on <%= new Date(review.review_date).toLocaleDateString() %></small>
          </div>
          
          <div class="review-actions">
            <a href="/reviews/edit/<%= review.review_id %>" class="btn-edit">Edit</a>
            <a href="/reviews/delete/<%= review.review_id %>" 
               class="btn-delete" 
               onclick="return confirm('Are you sure you want to delete this review?')">Delete</a>
          </div>
        </div>
      <% }) %>
    </div>
  <% } else { %>
    <p>You haven't written any reviews yet. <a href="/inv/">Browse our inventory</a> to find vehicles to review!</p>
  <% } %>
</div>

<style>
.user-reviews {
  max-width: 800px;
  margin: 0 auto;
  padding: 20px;
}

.reviews-list {
  margin-top: 20px;
}

.review-item {
  border: 1px solid #ddd;
  border-radius: 8px;
  padding: 20px;
  margin-bottom: 20px;
  background-color: #f9f9f9;
}

.review-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
  border-bottom: 1px solid #eee;
  padding-bottom: 10px;
}

.review-header h3 {
  margin: 0;
}

.review-header h3 a {
  color: #007bff;
  text-decoration: none;
}

.review-header h3 a:hover {
  text-decoration: underline;
}

.review-rating {
  font-size: 1.2em;
}

.star {
  color: #ddd;
}

.star.filled {
  color: #ffd700;
}

.review-content h4 {
  margin: 10px 0 5px 0;
  color: #333;
}

.review-content p {
  margin: 10px 0;
  line-height: 1.5;
}

.review-content small {
  color: #666;
}

.review-actions {
  margin-top: 15px;
  text-align: right;
}

.btn-edit, .btn-delete {
  display: inline-block;
  padding: 5px 15px;
  margin-left: 10px;
  text-decoration: none;
  border-radius: 4px;
  font-size: 14px;
}

.btn-edit {
  background-color: #28a745;
  color: white;
}

.btn-delete {
  background-color: #dc3545;
  color: white;
}

.btn-edit:hover {
  background-color: #218838;
}

.btn-delete:hover {
  background-color: #c82333;
}
</style>